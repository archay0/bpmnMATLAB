var sourceData8 = {"FileName":"C:\\Users\\Archay wakodikar\\Documents\\MATLAB\\src\\api\\APICaller.m","RawFileContents":["classdef APICaller\r","    % APICaller wraps communications with the OpenRouter API\r","    \r","    methods(Static)\r","        function raw = sendPrompt(prompt, options)\r","            % sendPrompt - Sendet eine Anfrage an die OpenRouter API\r","            %\r","            % Input:\r","            %   prompt - Der zu sendende Text-Prompt\r","            %   options - (Optional) Struktur mit zusätzlichen Optionen:\r","            %       .debug - Boolean, aktiviert ausführliche Protokollierung (Standard: false)\r","            %       .model - String, zu verwendendes Modell (Standard: 'microsoft/mai-ds-r1:free')\r","            %       .temperature - Numerisch, Kreativität (0-1, Standard: 0.7)\r","            %       .system_message - String, Systemanweisung (Standard: 'You are a helpful assistant specialized in BPMN.')\r","            %\r","            % Output:\r","            %   raw - Die verarbeitete API-Antwort\r","            \r","            % Standardoptionen setzen\r","            if nargin < 2\r","                options = struct();\r","            end\r","            \r","            if ~isfield(options, 'debug')\r","                options.debug = false;\r","            end\r","            \r","            if ~isfield(options, 'model')\r","                options.model = 'microsoft/mai-ds-r1:free'; % Standardmodell (OpenRouter)\r","            end\r","            \r","            if ~isfield(options, 'temperature')\r","                options.temperature = 0.7;\r","            end\r","            \r","            if ~isfield(options, 'system_message')\r","                options.system_message = 'You are a helpful assistant specialized in BPMN.';\r","            end\r","            \r","            % Laden des API-Schlüssels aus der Umgebung\r","            api_key = getenv('OPENROUTER_API_KEY');\r","            if isempty(api_key)\r","                % Versuchen, die API-Schlüssel aus der .env-Datei zu laden\r","                utilPath = fileparts(fileparts(mfilename('fullpath')));\r","                utilFolder = fullfile(utilPath, 'util');\r","                \r","                % Stellen Sie sicher, dass der util-Ordner im Pfad ist\r","                if ~any(contains(path, utilFolder))\r","                    addpath(utilFolder);\r","                end\r","                \r","                try\r","                    env = loadEnvironment();\r","                    if isfield(env, 'OPENROUTER_API_KEY')\r","                        api_key = env.OPENROUTER_API_KEY;\r","                    else\r","                        error('APICaller:NoAPIKey', 'OpenRouter API-Schlüssel nicht gefunden. Bitte setzen Sie die OPENROUTER_API_KEY Umgebungsvariable.');\r","                    end\r","                catch ME\r","                    error('APICaller:EnvError', 'Fehler beim Laden der Umgebungsvariablen: %s', ME.message);\r","                end\r","            end\r","            \r","            % Temporäre Dateien für Ein- und Ausgabe\r","            temp_dir = tempdir;\r","            input_file = fullfile(temp_dir, 'openrouter_input.json');\r","            output_file = fullfile(temp_dir, 'openrouter_output.json');\r","            \r","            % Erstelle JSON-Anfrage für OpenRouter API\r","            request_data = struct();\r","            request_data.messages = [\r","                struct('role', 'system', 'content', options.system_message),\r","                struct('role', 'user', 'content', prompt)\r","            ];\r","            request_data.model = options.model;\r","            request_data.temperature = options.temperature;\r","            request_data.max_tokens = 10000;\r","            \r","            % Schreibe JSON in temporäre Datei\r","            input_fid = fopen(input_file, 'w');\r","            if input_fid == -1\r","                error('APICaller:FileError', 'Fehler beim Erstellen der temporären Eingabedatei');\r","            end\r","            fprintf(input_fid, '%s', jsonencode(request_data));\r","            fclose(input_fid);\r","            \r","            % Erstelle und führe den curl-Befehl aus\r","            curl_cmd = sprintf('curl -s -X POST https://openrouter.ai/api/v1/chat/completions -H \"Content-Type: application/json\" -H \"Authorization: Bearer %s\" -H \"HTTP-Referer: http://localhost:3000\" -H \"X-Title: BPMN MATLAB Generator\" -d @\"%s\" > \"%s\"', ...\r","                api_key, input_file, output_file);\r","            \r","            if options.debug\r","                fprintf('Führe curl-Befehl aus:\\n%s\\n', curl_cmd);\r","                tic;\r","            end\r","            \r","            % Befehl ausführen\r","            [status, cmdout] = system(curl_cmd);\r","            \r","            if options.debug\r","                elapsed = toc;\r","                fprintf('curl-Aufruf abgeschlossen in %.2f Sekunden mit Status: %d\\n', elapsed, status);\r","                \r","                if ~isempty(cmdout)\r","                    fprintf('curl-Ausgabe: %s\\n', cmdout);\r","                end\r","            end\r","            \r","            % Fehlerbehandlung\r","            if status ~= 0\r","                error('APICaller:CurlError', 'curl-Fehler: %s', cmdout);\r","            end\r","            \r","            % Lese Ausgabe\r","            try\r","                output_fid = fopen(output_file, 'r');\r","                if output_fid == -1\r","                    error('APICaller:FileError', 'Fehler beim Öffnen der temporären Ausgabedatei');\r","                end\r","                response_text = fread(output_fid, '*char')';\r","                fclose(output_fid);\r","                \r","                % Parse JSON response\r","                raw = jsondecode(response_text);\r","                \r","                % Für Abwärtskompatibilität\r","                if isfield(raw, 'choices') && ~isempty(raw.choices)\r","                    if isfield(raw.choices(1), 'message') && isfield(raw.choices(1).message, 'content')\r","                        % Extrahiere den Text für die Abwärtskompatibilität\r","                        raw.choices(1).text = raw.choices(1).message.content;\r","                    end\r","                end\r","                \r","                if options.debug\r","                    fprintf('API-Antwort empfangen und erfolgreich geparst.\\n');\r","                end\r","                \r","            catch ME\r","                error('APICaller:ResponseError', 'Fehler beim Verarbeiten der API-Antwort: %s', ME.message);\r","            end\r","            \r","            % Aufräumen\r","            try\r","                delete(input_file);\r","                delete(output_file);\r","            catch\r","                warning('APICaller:Cleanup', 'Temporäre Dateien konnten nicht gelöscht werden');\r","            end\r","        end\r","    end\r","end"],"CoverageDisplayDataPerLine":{"Function":{"LineNumber":5,"Hits":8,"StartColumnNumbers":8,"EndColumnNumbers":50,"ContinuedLine":false,"Filterable":true,"FilterDataUUID":"8a946b83-bac8-40e6-81f7-c48f8905a159"},"Statement":[{"LineNumber":20,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":25,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"664295bf-5556-4ac1-9572-2883fae71c6a"},{"LineNumber":21,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":35,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"3b590bd7-f397-41fb-a9b5-a4ff97fa7d3a"},{"LineNumber":24,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":41,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"a32577fe-b651-442b-a3a3-f24c3d75f52c"},{"LineNumber":25,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":38,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"a84de369-da88-41eb-8b9a-b63a9902e8bb"},{"LineNumber":28,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":41,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"68c82e3d-dfd3-4a16-b6fe-c5e0012bce0e"},{"LineNumber":29,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":59,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"91887ce1-cb0e-4f98-bd29-3e2ab145ddfa"},{"LineNumber":32,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":47,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"4e593039-9b35-4b89-8297-a88b8f129d2b"},{"LineNumber":33,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":42,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"e7194e8e-8bd8-4fff-b2e1-1db81578f056"},{"LineNumber":36,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":50,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"0e4b4337-a791-45ca-b479-d365009497ec"},{"LineNumber":37,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":92,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"5bf542cb-8ccc-4dee-b1fe-bfeeedcc40fc"},{"LineNumber":41,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":51,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"02fffbde-51e3-4707-ac2c-976cb04b7f51"},{"LineNumber":42,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":31,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"aacc6502-d881-479f-9c35-a0fcbf9d45a4"},{"LineNumber":44,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":71,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"31a9f46c-ca3b-4427-8f19-e4f31a677505"},{"LineNumber":45,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":56,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"f63cea60-dc14-464c-a65f-77920b28a3bf"},{"LineNumber":48,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":51,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"1c21a786-b72e-4f06-84b3-85ab8857bbc4"},{"LineNumber":49,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":40,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"fe7ba7c3-8d19-4044-afba-1aba6c022459"},{"LineNumber":52,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":19,"ContinuedLine":false,"Filterable":true,"FilterDataUUID":"64e261a5-8a5a-4c1e-9437-a6653b92cd7a"},{"LineNumber":53,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":44,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"462e1a31-df3e-4321-b34b-b2694cdf8213"},{"LineNumber":54,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":57,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"f3c7f888-ea05-4aa3-92ec-2aa5405e2661"},{"LineNumber":55,"Hits":0,"StartColumnNumbers":24,"EndColumnNumbers":57,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"ed409745-ceec-4327-be6e-0420c73be2e4"},{"LineNumber":57,"Hits":0,"StartColumnNumbers":24,"EndColumnNumbers":155,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"33f36a17-afa5-4c28-8295-fbec57b46660"},{"LineNumber":59,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":24,"ContinuedLine":false,"Filterable":true,"FilterDataUUID":"74e0eb40-001e-449a-8c91-9d2fd9ba8c9c"},{"LineNumber":60,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":108,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"3700d246-1c40-4b84-8aec-e6787271e93a"},{"LineNumber":65,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":31,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"a41a4335-3dbb-4a76-bcbb-14872266258a"},{"LineNumber":66,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":69,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"21f3ed5c-45e4-4e3e-849a-352a5ef4ca63"},{"LineNumber":67,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":71,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"9be6ba76-8bb0-4e20-997e-d8018d57a864"},{"LineNumber":70,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":36,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"21180d39-0a98-4c77-94a5-192634e930e0"},{"LineNumber":71,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":37,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"0cf595c7-d4c7-4aa8-ab5a-42865db0bb53"},{"LineNumber":72,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":75,"ContinuedLine":true,"Filterable":false,"FilterDataUUID":"0cf595c7-d4c7-4aa8-ab5a-42865db0bb53"},{"LineNumber":73,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":57,"ContinuedLine":true,"Filterable":false,"FilterDataUUID":"0cf595c7-d4c7-4aa8-ab5a-42865db0bb53"},{"LineNumber":74,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":14,"ContinuedLine":true,"Filterable":false,"FilterDataUUID":"0cf595c7-d4c7-4aa8-ab5a-42865db0bb53"},{"LineNumber":75,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":47,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"df74c1cc-a276-4ee8-b740-73e6a069d297"},{"LineNumber":76,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":59,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"dc1dd2c8-d96b-40b3-a157-fffd7c3c8e15"},{"LineNumber":77,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":44,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"3d39f5b0-1f8f-4e34-9a70-3f57e9fe4b32"},{"LineNumber":80,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":47,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"26b23161-41f9-4624-bcc5-e049c092e2a2"},{"LineNumber":81,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":30,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"5eb4fe73-a6db-434a-8999-d0df95fca968"},{"LineNumber":82,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":98,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"c081327e-6d75-447c-8148-2ba31888bb0a"},{"LineNumber":84,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":63,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"4d3b2012-0a94-43b6-a8f7-2703af00a920"},{"LineNumber":85,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":30,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"1d86f7e8-eec3-4936-9032-f06657133791"},{"LineNumber":88,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":253,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"8729a6ce-0ee9-4e42-b104-6c1022230ddf"},{"LineNumber":89,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":50,"ContinuedLine":true,"Filterable":false,"FilterDataUUID":"8729a6ce-0ee9-4e42-b104-6c1022230ddf"},{"LineNumber":91,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":28,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"93ca2979-9698-4c51-9df3-eacd3ec15141"},{"LineNumber":92,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":66,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"eb64ac65-4a18-42ec-bba0-392eb1962a35"},{"LineNumber":93,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":20,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"1a89106c-fc49-49ba-b035-5da51dd56ae6"},{"LineNumber":97,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":48,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"1447d7a3-9607-4571-b54a-4d8686f6e2b2"},{"LineNumber":99,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":28,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"ffd36aeb-adff-4ff0-9ce1-b9578af88167"},{"LineNumber":100,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":30,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"bae7497e-537d-411f-946d-f04a3290be33"},{"LineNumber":101,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":104,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"c06e953e-bd47-4253-83ac-acb0706a7b2c"},{"LineNumber":103,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":35,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"cf84578b-1318-471e-8633-2ce0499fc2eb"},{"LineNumber":104,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":58,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"e17a78f5-68ce-43d6-b1ab-6fba647584c4"},{"LineNumber":109,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":26,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"16754536-aefd-4aab-a437-a1679ff889a7"},{"LineNumber":110,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":72,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"5ebff24f-69ab-4639-a17a-fe4f2a5bc1d0"},{"LineNumber":114,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":15,"ContinuedLine":false,"Filterable":true,"FilterDataUUID":"d032dff4-4980-4493-a6fb-d2777d0527dd"},{"LineNumber":115,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":53,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"eace2838-75f0-4ee4-ac7c-b1dfb77079d1"},{"LineNumber":116,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":35,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"3f6c1e29-54c1-4a32-afa7-46bb42821be9"},{"LineNumber":117,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":99,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"3ae90343-686c-492b-b7c1-c11a3a749c15"},{"LineNumber":119,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":60,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"355954e4-62ee-4dee-bf10-09ce1b8261d8"},{"LineNumber":120,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":35,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"145653c8-384c-421c-8ed9-bce1658de9f9"},{"LineNumber":123,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":48,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"0fe37d02-d9b5-4588-9f8b-3610393d306c"},{"LineNumber":126,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":67,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"4de5fd2a-cf98-48f2-8eb6-f2ea1e9e9c2b"},{"LineNumber":127,"Hits":8,"StartColumnNumbers":20,"EndColumnNumbers":103,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"2bbfff97-9e50-4542-8c76-47f5dcfac330"},{"LineNumber":129,"Hits":8,"StartColumnNumbers":24,"EndColumnNumbers":77,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"12b11166-b0b8-46e2-8fbc-ab88483ea6f3"},{"LineNumber":133,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":32,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"6964f892-d06f-4896-8bdb-374664d436f3"},{"LineNumber":134,"Hits":8,"StartColumnNumbers":20,"EndColumnNumbers":80,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"49c07ead-6bb5-4f43-8359-996e84c64f58"},{"LineNumber":137,"Hits":0,"StartColumnNumbers":12,"EndColumnNumbers":20,"ContinuedLine":false,"Filterable":true,"FilterDataUUID":"2ba452c2-876b-4062-a717-cb7af244a6ee"},{"LineNumber":138,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":108,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"9e935852-b78b-4c95-9db3-9e8eae76fa10"},{"LineNumber":142,"Hits":8,"StartColumnNumbers":12,"EndColumnNumbers":15,"ContinuedLine":false,"Filterable":true,"FilterDataUUID":"a1a05b38-06e6-415e-819b-3e96f4ab44de"},{"LineNumber":143,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":35,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"8b4b0fc3-ba55-4c01-a3d9-6870c30a9144"},{"LineNumber":144,"Hits":8,"StartColumnNumbers":16,"EndColumnNumbers":36,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"8680ade7-c09d-4848-86d6-a5c750660757"},{"LineNumber":145,"Hits":0,"StartColumnNumbers":12,"EndColumnNumbers":17,"ContinuedLine":false,"Filterable":true,"FilterDataUUID":"bd8fa256-2890-4a8d-973c-5c55b405e7a9"},{"LineNumber":146,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":96,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"6af28613-1241-4f21-85e1-182e1f6cbb9c"}]},"FilterData":[]}